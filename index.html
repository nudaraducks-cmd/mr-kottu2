<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L'ARISTO - Premium AR Experience</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-three.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        #container { width: 100vw; height: 100vh; }
        /* Loading Screen UI */
        #ui-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; font-family: 'serif'; background: rgba(0,0,0,0.7);
            z-index: 100; transition: opacity 0.5s;
        }
    </style>
</head>
<body>
    <div id="ui-overlay">
        <h1>L'ARISTO</h1>
        <p>AR ‡∂Ö‡∂≠‡∑ä‡∂Ø‡∑ê‡∂ö‡∑ì‡∂∏ ‡∑É‡∑ñ‡∂Ø‡∑è‡∂±‡∂∏‡∑ä ‡∑Ä‡∑ö...</p>
        <div id="status">‡∂ö‡∑ê‡∂∏‡∂ª‡∑è‡∑Ä ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</div>
    </div>
    <div id="container"></div>

    <script>
        const mindarThree = new window.MINDAR.IMAGE.MindARThree({
            container: document.querySelector("#container"),
            imageTargetSrc: "./targets.mind", // ‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂∏‡∑ô‡∂±‡∑î ‡∂ë‡∂ö‡∑ö mind file ‡∂ë‡∂ö
        });

        const {renderer, scene, camera} = mindarThree;
        const loader = new THREE.GLTFLoader();

        // üí° 1. ‡∂∏‡∑ô‡∂±‡∑î ‡∂ë‡∂ö ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∂≠‡∑ä ‡∑Ä‡∑í‡∂ß ‡∂ö‡∑ë‡∂∏ ‡∑Ä‡∂ª‡∑ä‡∂ú ‡∑Ä‡∑ô‡∂± ‡∑Ä‡∑ô‡∂±‡∂∏ ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏
        // ‡∂∏‡∑ô‡∑Ñ‡∑í 0, 1, 2 ‡∂∫‡∂±‡∑î ‡∂∏‡∑ô‡∂±‡∑î ‡∂ë‡∂ö‡∑ö targets ‡∑Ä‡∑ö.
        const setupFood = (targetIndex, modelPath) => {
            const anchor = mindarThree.addAnchor(targetIndex);
            loader.load(modelPath, (gltf) => {
                const model = gltf.scene;
                model.scale.set(0.1, 0.1, 0.1); // ‡∑É‡∂∫‡∑í‡∑É‡∑ä ‡∂ë‡∂ö ‡∂∏‡∑ô‡∂≠‡∂±‡∑í‡∂±‡∑ä ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                anchor.group.add(model);
            });
        };

        // ‡∂ö‡∑ë‡∂∏ ‡∑Ä‡∂ª‡∑ä‡∂ú 3‡∂ö‡∑ä ‡∑Ä‡∑ô‡∂± ‡∑Ä‡∑ô‡∂±‡∂∏ Load ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏
        setupFood(0, './assets/risotto.glb');
        setupFood(1, './assets/scallops.glb');
        setupFood(2, './assets/lamb.glb');

        // üí° 2. ‡∂¥‡∑í‡∂∫‡∂π‡∂± ‡∑É‡∂≠‡∑ä‡∂≠‡∑î (‡∂ö‡∂©‡∑ö ‡∂á‡∂≠‡∑î‡∑Ö‡∑ö ‡∂±‡∑í‡∂Ø‡∑Ñ‡∑É‡∑ö ‡∂∫‡∂± ‡∑É‡∂≠‡∑ä‡∂≠‡∑î)
        const animals = [];
        const loadCreature = (path, count) => {
            for(let i=0; i<count; i++) {
                loader.load(path, (gltf) => {
                    const creature = gltf.scene;
                    creature.position.set((Math.random()-0.5)*10, Math.random()*4, (Math.random()-0.5)*10);
                    creature.scale.set(0.04, 0.04, 0.04);
                    scene.add(creature);
                    animals.push({
                        mesh: creature,
                        speed: 0.005 + Math.random() * 0.01,
                        yOffset: Math.random() * Math.PI
                    });
                });
            }
        };

        loadCreature('./assets/bird.glb', 3);
        loadCreature('./assets/butterfly.glb', 4);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 1);
        scene.add(ambientLight);

        const start = async () => {
            await mindarThree.start();
            document.getElementById('ui-overlay').style.opacity = '0';
            setTimeout(() => document.getElementById('ui-overlay').style.display = 'none', 500);

            renderer.setAnimationLoop(() => {
                const t = Date.now() * 0.001;
                animals.forEach(a => {
                    // ‡∑É‡∂≠‡∑ä‡∂≠‡∑î ‡∂ª‡∑Ä‡∑î‡∂∏‡∂ß ‡∂¥‡∑í‡∂∫‡∂π‡∂± animation ‡∂ë‡∂ö
                    a.mesh.position.x += Math.sin(t + a.yOffset) * 0.02;
                    a.mesh.position.z += Math.cos(t + a.yOffset) * 0.02;
                    a.mesh.position.y += Math.sin(t * 2) * 0.005;
                    a.mesh.rotation.y += 0.01;
                });
                renderer.render(scene, camera);
            });
        }
        start();
    </script>
</body>
</html>
